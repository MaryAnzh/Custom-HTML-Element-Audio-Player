(()=>{"use strict";class t{constructor(t,e="div",i="",s="",n=null){const o=document.createElement(e);Array.isArray(i)&&i.forEach((t=>o.classList.add(t))),"string"==typeof i&&(o.className=i),o.textContent=s,t&&t.append(o),n&&n.forEach((t=>o.setAttribute(t.name,t.value))),this.node=o}destroy(){this.node.remove()}}class e extends t{constructor(){super(null,"nav","nav"),this._navLists=[{name:"main",key:"MAIN"},{name:"about",key:"ABOUT"}],this.nodeKey="NAV",this.navItems=[],this._ul=new t(this.node,"ul","nav__list","",null),this._navLists.forEach(((e,i)=>{const s=new t(this._ul.node,"li","nav__list__item","",null),n=0===i?"#/":`#/${e.name}`,o=new t(s.node,"a","nav__list__item__link","",[{name:"href",value:n}]);this.navItems.push({element:o.node,perentKey:this.nodeKey,elementKey:e.key})}))}translate(t){this.navItems.forEach((e=>{const i=e.elementKey;e.element.textContent=t.NAV[i]}))}}class i extends t{constructor(i){super(null,"header","header"),this.navItems=[],this.langs=i,this.container=new t(this.node,"div","container"),this._nav=new e,this.navItems=this._nav.navItems,this.container.node.appendChild(this._nav.node),this.langsWrap=new t(this.container.node,"div","container__langs"),this.langs.forEach(((e,i)=>{const s=new t(this.langsWrap.node,"div","header__langs__item"),n=new t(s.node,"input","header__langs__item__input","",[{name:"name",value:"lang"},{name:"id",value:`${e}`},{name:"type",value:"radio"}]);n.node.onchange=()=>this.onChange(e),0===i&&(n.node.checked=!0),new t(s.node,"label","header__langs__item__label",e,[{name:"for",value:`${e}`}])}))}translate(t){this._nav.translate(t)}selectCurrentPage(t){switch(this.navItems.forEach((t=>t.element.classList.remove("active"))),t){case"/":this.navItems[0].element.classList.add("active");break;case"/about":this.navItems[1].element.classList.add("active")}}}class s{constructor(){this.node=document.createElement("footer"),this.node.classList.add("footer"),this.node.textContent="footer"}}const n=[{title:"Jingle Bell Rock",src:"assets/audio/Christmas_Time_-_Jingle_Bell_Rock_(musmore.com).mp3"},{title:"Jingle Bells",src:"assets/audio/Jingle Bells - Christmas Songs.mp3"},{title:"Happy New Year",src:"assets/audio/Happy New Year.mp3"}];class o extends t{constructor(){super(null,"div",["main-page","page"]),this.name="main-page",this.perentKey="MAIN",this.playList=n,this.destroy=()=>{this.node.remove()},this.title=new t(this.node,"h2","main-page__title","Custom HTML Element"),this.audio=document.createElement("audio-player"),this.audio.classList.add("main-page__audio-player"),this.node.appendChild(this.audio),this.audio.playList=n}translate(t){this.title.node.textContent=t.MAIN.TITLE}}class a extends t{constructor(){super(null,"div",["about-page","page"]),this.name="about-page",this.destroy=()=>{this.node.remove()},this._title=new t(this.node,"h2","about-page__title",this.name,null)}translate(t){}}class l extends t{constructor(){super(null,"div",["not-found","page"]),this.name="not-found-page",this.destroy=()=>{this.node.remove()},this._title=new t(this.node,"h2",`${this.name}__title`,this.name)}translate(t){}}const d={NAV:{MAIN:"main",ABOUT:"about"},MAIN:{TITLE:"Custom HTML Element"}},h={NAV:{MAIN:"главная",ABOUT:"о проекте"},MAIN:{TITLE:"Пользовательский HTML элемент"}},r={NAV:{MAIN:"галоўная",ABOUT:"аб праекце"},MAIN:{TITLE:"Спецыялізаваны элемент кіравання"}};class c{constructor(){this.listeners=[]}add(t){this.listeners.push(t)}emit(t){this.listeners.forEach((e=>e(t)))}remove(t){this.listeners=this.listeners.filter((e=>e!==t))}}const u=new class{constructor(){this.onChange=new c,this.langs=["en","ru","by"],this._lang="en"}get lang(){return this._lang}set lang(t){this._lang=t,this.onChange.emit(this.translate(t))}translate(t){switch(t){case"ru":return h;case"by":return r;default:return d}}},m=new class extends t{constructor(){super(document.body,"div","wrapper"),this.currentPage=null,this.translate=t=>{this.header.translate(t),this.currentPage&&this.currentPage.translate(t)},this.header=new i(u.langs),this.footer=new s,this.main=new t(null,"main","main"),this.node.append(this.header.node,this.main.node,this.footer.node),this.header.onChange=t=>{u.lang=t},u.onChange.add(this.translate)}addPage(t){this.header.selectCurrentPage(t);let e=null;switch(t){case"/":e=new o;break;case"/about":e=new a;break;default:e=new l}this.currentPage=e,this.main.node.appendChild(e.node),u.lang="en"}removePage(){null!==this.currentPage&&this.currentPage.destroy()}destroy(){u.onChange.remove(this.translate),super.destroy()}},p=(t,e,i,s,n,o)=>({id:t,location:e,title:i,src:s,audio:n,time:o});class _{constructor(){}static viewTime(t){const e=1e3*t;let i=Math.floor(e/1e3/60),s=Math.floor((e-1e3*i*60)/1e3);return s>59&&(i+=1,s-=60),(i<10?`0${i}`:i)+":"+(s<10?`0${s}`:s)}}class y extends t{constructor(e){super(e,"div","audio"),this._audio=null,this.isPlay=!1,this.audioControls=new t(this.node,"div","audio__controls"),this.topContainer=new t(this.audioControls.node,"div","audio__controls__top"),this.playButton=new t(this.topContainer.node,"button",["audio__controls__top__button","play-button"]);const i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttribute("viewBox","0 0 30 15.7"),i.innerHTML='<path d="M29.7,1.4l-14,14c-0.4,0.4-1,0.4-1.4,0l-14-14c-0.4-0.4-0.4-1,0-1.4h29.4C30.1,0.4,30.1,1,29.7,1.4z"/>\n        ',this.playButton.node.appendChild(i),this.playButton.node.onclick=()=>this.onClick(),this.audioTitle=new t(this.topContainer.node,"h4","audio__controls__top__title","Title"),this.timeBar=new t(this.audioControls.node,"div","audio__controls__time-bar"),this.timeBarRunner=new t(this.timeBar.node,"div","audio__controls__time-bar__runner"),this.times=new t(this.audioControls.node,"div","audio__controls__times"),this.timesTimer=new t(this.times.node,"p","audio__controls__times__timer","00:00"),this.audioTime=new t(this.times.node,"p","audio__controls__times__audio-time","00:00"),this.soundBar=new t(this.audioControls.node,"div","audio__controls__sound-bar"),this.soundBarRunner=new t(this.soundBar.node,"div","audio__controls__sound-bar__runner")}update(t,e,i){this.audioTime.node.textContent=_.viewTime(e),this.audioTitle.node.textContent=t,this._audio=i}play(){null!==this._audio?(this._audio.play(),this.isPlay=!0,this._audio.onended=()=>this.onEnded(),this.playButton.node.classList.add("pause-button"),this.playButton.node.classList.remove("play-button"),this.startTimer()):this.audioTitle.node.textContent="Add audio in playlist"}pause(){this._audio.pause(),this.isPlay=!1,this._audio.onended=null,this.playButton.node.classList.remove("pause-button"),this.playButton.node.classList.add("play-button"),this.stopTimer()}resetAudioTime(){this._audio.currentTime=0,this._audio.onended=null}resetAudioData(){this.audioTime.node.textContent=_.viewTime(0),this.audioTitle.node.textContent="Title",this._audio=null}startTimer(){this._timer=setInterval((()=>{const t=this._audio.currentTime;this.timesTimer.node.textContent=_.viewTime(t)}),250)}stopTimer(){clearInterval(this._timer)}destroy(){this.playButton.node.onclick=null,clearInterval(this._timer),super.destroy()}}class v extends t{constructor(e,i,s){super(null,"li","items-list__item"),this.name="waitList",this.id=s,this.icon=new t(this.node,"div",["items-list__item__icon","arrow-to-left"]);const n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("viewBox","0 0 30 15.7"),n.innerHTML='<path d="M29.7,1.4l-14,14c-0.4,0.4-1,0.4-1.4,0l-14-14c-0.4-0.4-0.4-1,0-1.4h29.4C30.1,0.4,30.1,1,29.7,1.4z"/>\n        ',this.icon.node.appendChild(n),this.icon.node.onclick=()=>this.onClick(),this.container=new t(this.node,"div","items-list__item__info"),this.title=new t(this.container.node,"p","",e),this.time=new t(this.container.node,"p","",_.viewTime(i))}destroy(){this.icon.node.onclick=null,super.destroy()}}class w extends t{constructor(e,i,s){super(null,"li",["items-list__item","play-list-item"]),this.name="playList",this.id=s,this.playIcon=new t(this.node,"div",["items-list__item__icon","not-active-item"]);const n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("viewBox","0 0 30 15.7"),n.innerHTML='<path d="M29.7,1.4l-14,14c-0.4,0.4-1,0.4-1.4,0l-14-14c-0.4-0.4-0.4-1,0-1.4h29.4C30.1,0.4,30.1,1,29.7,1.4z"/>\n        ',this.playIcon.node.appendChild(n),this.playIcon.node.onclick=()=>this.onClickPlayPause(),this.container=new t(this.node,"div",["items-list__item__info","play-list-item__info"]),this.title=new t(this.container.node,"p","",e);const o=_.viewTime(i);this.time=new t(this.container.node,"p","",o),this.arrowIcon=new t(this.node,"div",["items-list__item__icon","arrow-to-right"]);const a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("viewBox","0 0 30 15.7"),a.innerHTML='<path d="M29.7,1.4l-14,14c-0.4,0.4-1,0.4-1.4,0l-14-14c-0.4-0.4-0.4-1,0-1.4h29.4C30.1,0.4,30.1,1,29.7,1.4z"/>\n        ',this.arrowIcon.node.appendChild(a),this.arrowIcon.node.onclick=()=>this.onClickMoveToWaitList()}active(){this.playIcon.node.classList.remove("not-active-item"),this.playIcon.node.classList.add("active-item-pause")}deactivate(){this.playIcon.node.classList.remove("active-item-pause","active-item-play"),this.playIcon.node.classList.add("not-active-item")}viewPlay(){this.playIcon.node.classList.remove("active-item-pause"),this.playIcon.node.classList.add("active-item-play")}viewPause(){this.playIcon.node.classList.remove("active-item-play"),this.playIcon.node.classList.add("active-item-pause")}destroy(){this.arrowIcon.node.onclick=null,this.playIcon.node.onclick=null,super.destroy()}}class L extends HTMLElement{constructor(){super(),this.isAudioPlay=!1,this.audioItem=null,this.onClick=(t,e)=>{"moveItemToPlayList"===t&&this.moveItemToPlayList(e),"playStopAudio"===t&&this.playStopAudio(e),"moveItemToWaitList"===t&&this.moveItemToWaitList(e)},this.onEnded=()=>{setTimeout((()=>{let t;const e=this._playListItems.length;this.audioItem.deactivate(),this._playListItems.forEach(((i,s)=>{this.audioItem===i&&(t=s===e-1?this._playListItems[0]:this._playListItems[s+1])})),this.audioItem=t;const i=this._audioList.find((e=>e.id===t.id));t.active(),t.viewPlay(),this.controls.update(i.title,i.time,i.audio),this.controls.play()}),1e3)},this.moveItemToPlayList=t=>{this._waitListItems=this._waitListItems.filter((e=>e!==t));const e=t.id;t.destroy();const i=this._audioList.filter((t=>t.id===e))[0];i.location="playList";const s=new w(i.title,i.time,e);this.playListUl.node.appendChild(s.node),this._playListItems.push(s),1===this._playListItems.length&&(s.active(),this.audioItem=s,this.controls.update(i.title,i.time,i.audio)),s.onClickPlayPause=()=>this.onClick("playStopAudio",s),s.onClickMoveToWaitList=()=>this.onClick("moveItemToWaitList",s)},this.moveItemToWaitList=t=>{const e=t.id;let i;if(this._playListItems.forEach(((t,s)=>{t.id==e&&(i=0===s&&1===this._playListItems.length?null:0===s?this._playListItems[1]:this._playListItems[s-1])})),this._playListItems=this._playListItems.filter((t=>t.id!==e)),this.audioItem===t)if(console.log("Это активный трек"),this.isAudioPlay&&(this.controls.pause(),this.controls.resetAudioTime(),this.isAudioPlay=!1,this.audioItem=null),null!==i){i.active();const t=this._audioList.find((t=>t.id==i.id));this.controls.update(t.title,t.time,t.audio),this.audioItem=i}else this.controls.resetAudioData(),this.audioItem=null;t.destroy();const s=this._audioList.find((t=>t.id===e));s.location="waitList";const n=new v(s.title,s.time,e);this.waitingListUl.node.appendChild(n.node),this._waitListItems.push(n),n.onClick=()=>this.onClick("moveItemToPlayList",n)},this.playStopAudio=t=>{if(null!=t)if(this.audioItem===t)this.isAudioPlay?(this.audioItem.viewPause(),this.isAudioPlay=!1,this.controls.pause()):(this.audioItem.viewPlay(),this.isAudioPlay=!0,this.controls.play());else{const e=t.id,i=this._audioList.filter((t=>t.id===e))[0];this.audioItem.deactivate(),this.controls.pause(),this.controls.resetAudioTime(),this.audioItem=t,this.controls.update(i.title,i.time,i.audio),t.active(),t.viewPlay(),this.controls.play(),this.isAudioPlay=!0}else this.controls.play()},this._audioList=[],this._playListItems=[],this._waitListItems=[]}get playList(){return JSON.parse(this.getAttribute("playList"))}set playList(t){this.setAttribute("playList",JSON.stringify(t))}connectedCallback(){return e=this,i=void 0,n=function*(){this.container=new t(this,"section","audio-player"),this.controls=new y(this.container.node),this.controls.onEnded=()=>this.onEnded(),this.controls.onClick=()=>this.onClick("playStopAudio",this.audioItem),this.lists=new t(this.container.node,"div","audio-player__lists"),this.playListWrap=new t(this.lists.node,"div",["audio-player__lists__play-list","list"]),this.playListTitle=new t(this.playListWrap.node,"h4","list__title","Play List"),this.playListUl=new t(this.playListWrap.node,"ul","audio-player__lists__play-list__list"),this.waitingList=new t(this.lists.node,"h3",["audio-player__lists__waiting-list","list"]),this.waitingListTitle=new t(this.waitingList.node,"h4","list__title","Waiting list"),this.waitingListUl=new t(this.waitingList.node,"ul","items-list");for(let t=0;t<this.playList.length;t++){const e=this.playList[t],i=new Audio;i.src=e.src;const s=yield new Promise((t=>{i.onloadedmetadata=()=>{t(i.duration)}})),n=`audioItem_${t}`,o=new v(e.title,s,n);o.onClick=()=>this.onClick("moveItemToPlayList",o);const a=p(n,"waitList",e.title,e.src,i,s);this._waitListItems.push(o),this.waitingListUl.node.appendChild(o.node),this._audioList.push(a)}},new((s=void 0)||(s=Promise))((function(t,o){function a(t){try{d(n.next(t))}catch(t){o(t)}}function l(t){try{d(n.throw(t))}catch(t){o(t)}}function d(e){var i;e.done?t(e.value):(i=e.value,i instanceof s?i:new s((function(t){t(i)}))).then(a,l)}d((n=n.apply(e,i||[])).next())}));var e,i,s,n}disconnectedCallback(){}attributeChangedCallback(t,e,i){}destroy(){this.remove()}}L.observedAttributes=["playList"],customElements.define("audio-player",L);let g=null;const I=new class{constructor(t){this.route=()=>{const t=this.parseRequestURL();return this.routes.filter((e=>e==t))[0]},this.parseRequestURL=()=>{let t=(location.hash.slice(1).toLowerCase()||"/").split("/"),e={resource:null,id:null,verb:null};return e.resource=t[1],e.id=t[2],e.verb=t[3],(e.resource?"/"+e.resource:"/")+(e.id?"/:id":"")+(e.verb?"/"+e.verb:"")},this.routes=t,this.notFound=new l}}(["/","/about"]),C=()=>{const t=I.route();g=t,m.addPage(t)};window.onload=()=>{C()},window.addEventListener("hashchange",(()=>{m.removePage(),C()}))})();
//# sourceMappingURL=main.js.map